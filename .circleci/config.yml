version: 2.1
orbs:
  docker: circleci/docker@1.1.0

jobs:
  build:
    docker:
      - image: cimg/node:17.0

    steps:
      - checkout
      - setup_remote_docker

      - run:
          name: Install GeckoDriver
          command: |
              wget -N https://github.com/mozilla/geckodriver/releases/download/v0.30.0/geckodriver-v0.30.0-linux64.tar.gz
              tar -xzf geckodriver-v0.30.0-linux64.tar.gz
              chmod +x geckodriver
              sudo mv geckodriver /usr/local/bin/
      - run:
          name: Configure GeckoDriver
          command: |
            echo 'export PATH=$PATH:/usr/local/bin' >> $BASH_ENV

      - run:
          name: Install libnss3
          command: |
            sudo apt-get update
            sudo apt-get install -y libnss3

      - run:
          name: Run GeckoDriver
          command: |
            geckodriver --version
            # Thêm các lệnh khác liên quan đến GeckoDriver ở đây

      - run:
          name: Test Docker
          command: docker --version

      - run:
          name: Install Dependencies
          command: npm install
          working_directory: /home/circleci/project/client

#       - run:
#           name: Test
#           command: npm run wdio
#           working_directory: /home/circleci/project/client

workflows:
  build-and-deploy:
    jobs:
      - build
